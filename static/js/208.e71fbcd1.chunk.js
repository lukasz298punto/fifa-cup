"use strict";(self.webpackChunkfifa_cup=self.webpackChunkfifa_cup||[]).push([[208],{3208:function(e,n,r){r.r(n),r.d(n,{default:function(){return ye}});var t=r(4165),a=r(5861),s=r(1413),o=r(9439),l=r(6650),i=r(1091),c=r(228),d=r(166),u=r(4293),p=r(3142),m=r(763),f=(r(1361),r(2791)),x=r(1134),h=r(3168),v=r(6493),j=r(7723),y=r(6595),Z=r(9001),g=r(7689),N=r(8506),w=r(6582),b=r(9276),k=r(8182),C=r(184);var I=function(e){var n=e.children,r=e.value,t=e.index,a=e.className;return(0,C.jsx)("div",{className:(0,k.Z)(r!==t&&"hidden"),children:(0,C.jsx)(b.Z,{className:a,children:n})})},P=r(4259),S=r(1508),A=r(501),B=r(3978),D=r(5419),q=r(788),z=r(464),M=r(5629),E=r(6132),Q=r(9562),W=r(4346);function F(e){var n=e.onClose,r=e.onPick,t=e.disabledPlayers,a=e.open,o=(0,p.qu)(),l=o.data,i=o.isLoading,c=(0,h.$)().t;return(0,C.jsx)(q.Z,{onClose:n,open:a,children:(0,C.jsxs)(N.g,{loading:i,children:[(0,C.jsx)(z.Z,{children:c("Wybierz zawodnika")}),(0,C.jsx)(M.Z,{sx:{pt:0},children:(0,m.map)(null===l||void 0===l?void 0:l.docs,(function(e){var n=e.data();return(0,C.jsxs)(E.ZP,{disabled:(0,m.includes)(t,e.id),button:!0,onClick:function(){return r((0,s.Z)((0,s.Z)({},n),{},{id:e.id}))},children:[(0,C.jsx)(Q.Z,{children:(0,C.jsx)(B.Z,{sx:{bgcolor:D.Z[100],color:D.Z[600]},children:(0,C.jsx)(A.Z,{})})}),(0,C.jsx)(W.Z,{primary:n.firstName+" "+n.lastName})]},e.id)}))})]})})}var $=f.memo(F),L=r(1487),O=r(6815),V=r(1680),G=r(9773),T=r(9827),U=r(807),X=r(5987),R=r(3811),Y=r(8439),_=["onAdd"];var H=function(e){var n=e.onAdd,r=(0,X.Z)(e,_);return(0,C.jsx)(R.Z,(0,s.Z)((0,s.Z)({className:"p-0",size:"small",color:"primary",onClick:n},r),{},{children:(0,C.jsx)(Y.Z,{})}))},J=r(4337),K=r(2400),ee=r(7539);function ne(e){var n=e.players,r=e.promotion,t=e.onAddPlayer,a=e.results,s=e.className,o=(0,h.$)().t,l=(0,p.qu)().data,i=(0,f.useCallback)((function(e){return(0,m.reduce)(a,(function(n,r){var t=r.playerA,a=r.playerB;if(t.score&&a.score){if(t.id===e)return(0,m.concat)(n,{status:(0,K.L$)(parseInt(t.score)-parseInt(a.score)),plus:parseInt(t.score),minus:parseInt(a.score),diff:parseInt(t.score)-parseInt(a.score),pkt:(0,K.TF)(parseInt(t.score)-parseInt(a.score))});if(a.id===e)return(0,m.concat)(n,{status:(0,K.L$)(parseInt(a.score)-parseInt(t.score)),plus:parseInt(a.score),minus:parseInt(t.score),diff:parseInt(a.score)-parseInt(t.score),pkt:(0,K.TF)(parseInt(a.score)-parseInt(t.score))})}return n}),[])}),[a]),c=(0,f.useMemo)((function(){if((0,m.isEmpty)(a))return(0,m.map)(n,(function(e){return{formId:e.formId,id:e.id||"",pkt:0,m:0,w:0,r:0,p:0,brPlus:0,brMinus:0,brDiff:0}}));var e=(0,m.map)(n,(function(e){var n=i(e.id);return{formId:e.formId,id:e.id||"",pkt:(0,m.reduce)(n,(function(e,n){return e+n.pkt}),0),m:(0,m.size)(n),w:(0,m.size)((0,m.filter)(n,{status:P.Qk.W})),r:(0,m.size)((0,m.filter)(n,{status:P.Qk.D})),p:(0,m.size)((0,m.filter)(n,{status:P.Qk.L})),brPlus:(0,m.reduce)(n,(function(e,n){return e+n.plus}),0),brMinus:(0,m.reduce)(n,(function(e,n){return e+n.minus}),0),brDiff:(0,m.reduce)(n,(function(e,n){return e+n.diff}),0)}}));return(0,m.orderBy)(e,["pkt","brDiff","brPlus"],["desc","desc","desc"])}),[a,n,i]);return(0,C.jsx)(J.x,{className:s,children:(0,C.jsxs)(V.Z,{children:[(0,C.jsx)(T.Z,{children:(0,C.jsxs)(U.Z,{children:[(0,C.jsx)(ee.p,{align:"left",children:o("Zawodnik")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("Pkt")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("M")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("W")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("R")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("P")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("Br+")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("Br-")}),(0,C.jsx)(ee.p,{width:50,className:"text-center",children:o("+/-")})]})}),(0,C.jsx)(G.Z,{children:(0,m.map)(c,(function(e,n){var a=e.formId,s=e.id,o=e.pkt,i=e.m,c=e.w,d=e.r,u=e.p,p=e.brPlus,m=e.brMinus,f=e.brDiff;return(0,C.jsxs)(U.Z,{style:{backgroundColor:r>n?L.Z[100]:O.Z[100]},children:[(0,C.jsx)(ee.p,{component:"th",scope:"row",children:s?(0,K.MX)(s,null===l||void 0===l?void 0:l.docs):(0,C.jsx)(H,{onAdd:function(){t(n)}})}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center font-bold",children:o}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:i}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:c}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:d}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:u}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:p}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:m}),(0,C.jsx)(ee.p,{component:"th",scope:"row",className:"text-center",children:f})]},a)}))})]})})}var re=f.memo(ne),te=r(5953),ae=r(9911),se=r(1872),oe=r(5088);function le(e){var n=e.control,r=e.result,t=e.onAdd,a=e.typeOfWin,s=e.disabledPlayers,l=e.formName,i=(0,p.qu)().data,d=(0,h.$)().t,u=(0,f.useState)(!1),v=(0,o.Z)(u,2),y=v[0],Z=v[1],g=(0,f.useState)(!1),N=(0,o.Z)(g,2),w=N[0],b=N[1],k=(0,f.useCallback)((function(){Z(!1)}),[]),I=(0,f.useCallback)((function(){b(!1)}),[]),P=function(e){return"".concat(l,".").concat(e)},S=(0,x.qo)({control:n,name:P("playerA")}),A=(0,x.qo)({control:n,name:P("playerB")}),B=function(e,n){e&&n&&t&&(0,m.forEach)((0,m.range)(0,(0,oe.EQ)(a).with(j.q.TwoMatch,(function(){return 2})).with(j.q.Best3,(function(){return 3})).with(j.q.Best5,(function(){return 5})).otherwise((function(){return 0}))),(function(){t({playerA:{id:e,score:""},playerB:{id:n,score:""}})}))},D=t&&(null===S||void 0===S?void 0:S.score)&&(null===A||void 0===A?void 0:A.score)&&(null===S||void 0===S?void 0:S.score)===(null===A||void 0===A?void 0:A.score),q=!(null!==S&&void 0!==S&&S.id)||!(null!==A&&void 0!==A&&A.id);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(te.ZP,{container:!0,className:"py-1 items-center",wrap:"nowrap",children:[(0,C.jsxs)(te.ZP,{item:!0,xs:5,className:"flex justify-end items-center",children:[(0,C.jsx)(x.Qr,{defaultValue:r.playerA.id,name:P("playerA.id"),control:n,render:function(e){var n=e.field,r=n.value,t=n.onChange;e.fieldState.error;return(0,C.jsx)("span",{className:"text-xs break-all",children:r?(0,K.MX)(r,null===i||void 0===i?void 0:i.docs):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(H,{onAdd:function(){Z(!0)}}),(0,C.jsx)($,{onClose:k,open:y,onPick:function(e){t(e.id),B(e.id,null===A||void 0===A?void 0:A.id)},disabledPlayers:s})]})})}}),D&&(0,C.jsx)(x.Qr,{defaultValue:r.playerB.penaltyScore,name:P("playerA.penaltyScore"),control:n,render:function(e){var n=e.field,r=n.onChange,t=n.value;e.fieldState.error;return(0,C.jsx)(ae.Z,{disabled:q,inputProps:{className:"p-1 text-center text-xs"},value:t,onChange:function(e){r((0,K.Pw)(e.target.value))},className:"mx-1 w-10",size:"small",type:"number",variant:"filled",placeholder:d("kr.")})}})]}),(0,C.jsx)(te.ZP,{item:!0,children:(0,C.jsxs)(c.Z,{className:"flex flex-nowrap",children:[(0,C.jsx)(x.Qr,{defaultValue:r.playerA.score,name:P("playerA.score"),control:n,render:function(e){var n=e.field,r=n.onChange,t=n.value;e.fieldState.error;return(0,C.jsx)(ae.Z,{disabled:q,inputProps:{className:"p-1 text-center"},value:t,onChange:function(e){r((0,K.Pw)(e.target.value))},className:"mx-1 w-10",size:"small",type:"number",variant:"outlined"})}}),":",(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.Qr,{defaultValue:r.playerB.score,name:P("playerB.score"),control:n,render:function(e){var n=e.field,r=n.onChange,t=n.value;e.fieldState.error;return(0,C.jsx)(ae.Z,{disabled:q,inputProps:{className:"p-1 text-center"},value:t,onChange:function(e){r((0,K.Pw)(e.target.value))},className:"mx-1 w-10",size:"small",type:"number",variant:"outlined"})}}),D&&(0,C.jsx)(x.Qr,{defaultValue:r.playerB.penaltyScore,name:P("playerB.penaltyScore"),control:n,render:function(e){var n=e.field,r=n.onChange,t=n.value;e.fieldState.error;return(0,C.jsx)(ae.Z,{disabled:q,inputProps:{className:"p-1 text-center text-xs"},value:t,onChange:function(e){r((0,K.Pw)(e.target.value))},className:"mx-1 w-10",size:"small",type:"number",variant:"filled",placeholder:d("kr.")})}})]})]})}),(0,C.jsx)(te.ZP,{item:!0,className:"flex justify-start items-center",xs:5,children:(0,C.jsx)(x.Qr,{defaultValue:r.playerB.id,name:P("playerB.id"),control:n,render:function(e){var n=e.field,r=n.value,t=n.onChange;e.fieldState.error;return(0,C.jsx)("span",{className:"text-xs break-all",children:r?(0,K.MX)(r,null===i||void 0===i?void 0:i.docs):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(H,{onAdd:function(){b(!0)}}),(0,C.jsx)($,{onClose:I,open:w,onPick:function(e){t(e.id),B(null===S||void 0===S?void 0:S.id,e.id)},disabledPlayers:s})]})})}})})]}),(0,C.jsx)(se.Z,{})]})}var ie=f.memo(le),ce=r(8163);function de(e){var n=e.control,r=e.typeOfWin,t=e.promotion,a=e.index,s=e.phaseIndex,l=(e.playerCount,(0,h.$)().t),i=(0,x.Dq)({control:n,name:"phases.".concat(s,".groups.").concat(a,".players"),keyName:"formId"}),d=i.fields,u=(i.replace,i.update),p=(0,x.Dq)({control:n,name:"phases.".concat(s,".groups.").concat(a,".results"),keyName:"formId"}),v=p.fields,y=p.replace,Z=(0,f.useState)(null),g=(0,o.Z)(Z,2),N=g[0],w=g[1],b=(0,f.useCallback)((function(e){w(e),A(!0)}),[]),k=(0,f.useState)(!1),I=(0,o.Z)(k,2),P=I[0],A=I[1],B=(0,f.useCallback)((function(){w(null),A(!1)}),[]),D=(0,f.useMemo)((function(){return(0,m.compact)((0,m.map)(d,"id"))}),[d]),q=(0,x.qo)({control:n,name:"phases.".concat(s,".groups.").concat(a,".results")}),z=(0,f.useCallback)((function(e){u(N,{id:e.id,firstName:e.firstName,lastName:e.lastName}),B()}),[B,N,u]);return console.log(v,"results"),(0,ce.Z)((function(){if((0,m.isEmpty)((0,m.filter)(d,(function(e){return!e.id})))&&(0,m.isEmpty)(v)){var e=(0,m.map)((0,m.combinations)(d,2),(function(e){var n=(0,o.Z)(e,2),r=n[0],t=n[1];return{playerA:{id:r.id||"",score:""},playerB:{id:t.id||"",score:""}}}));y(r===j.q.TwoMatch?(0,m.concat)(e,(0,m.map)(e,(function(e){var n=e.playerA;return{playerA:e.playerB,playerB:n}}))):e)}}),[d]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)($,{onClose:B,open:P,onPick:z,disabledPlayers:D}),(0,C.jsx)(re,{className:"my-2",players:d,onAddPlayer:b,promotion:t,results:q}),(0,C.jsxs)(c.Z,{children:[(0,m.isEmpty)(v)&&(0,C.jsx)(S.Z,{severity:"info",variant:"standard",children:l("Wprowad\u017a wszystkich graczy aby wygenerowa\u0107 terminarz")}),(0,m.map)(v,(function(e,r){return e.playerA.id&&e.playerB.id&&(0,C.jsx)(ie,{control:n,result:e,formName:"phases.".concat(s,".groups.").concat(a,".results.").concat(r)},e.formId)}))]})]})}var ue=f.memo(de);function pe(e){var n=e.schema,r=e.index,t=e.control,a=(0,f.useState)("0"),s=(0,o.Z)(a,2),l=s[0],c=s[1],d=(0,h.$)().t,u=n.phases[r];return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(w.Z,{variant:"outlined",children:(0,m.map)(u.groups,(function(e,n){return(0,C.jsxs)(i.Z,{variant:l===String(n)?"contained":"outlined",size:"small",onClick:function(){return function(e){c(e)}(String(n))},children:[d("Grupa")," ",P.CR[n]]},n)}))}),(0,m.map)(u.groups,(function(e,n){return(0,C.jsx)(I,{value:l,index:String(n),children:(0,C.jsx)(ue,{playerCount:e.playerCount,control:t,typeOfWin:u.typeOfWin,promotion:e.promotion,index:n,phaseIndex:r})},n)}))]})}var me=f.memo(pe),fe=r(3433);function xe(e){var n=e.schema,r=e.index,t=e.control,a=(0,x.Dq)({control:t,name:"phases.".concat(r,".results"),keyName:"formId"}),s=a.fields,o=a.append,l=(a.replace,n.phases[r]),i=(0,x.qo)({control:t,name:"phases.".concat(r,".results")}),c=(0,f.useCallback)((function(e){o(e)}),[o]),d=(0,f.useMemo)((function(){return(0,m.compact)([].concat((0,fe.Z)((0,m.flatMap)(i,"playerA.id")),(0,fe.Z)((0,m.flatMap)(i,"playerB.id"))))}),[i]);return console.log(s,"results---222"),(0,C.jsx)(C.Fragment,{children:(0,m.map)(s,(function(e,n){return(0,C.jsx)(ie,{formName:"phases.".concat(r,".results.").concat(n),disabledPlayers:d,typeOfWin:l.typeOfWin,control:t,result:e,onAdd:c},e.formId)}))})}var he,ve=f.memo(xe),je=r(8977);!function(e){e[e.End=0]="End",e[e.Update=1]="Update",e[e.Start=2]="Start"}(he||(he={}));var ye=function(){var e=(0,g.UO)().id,n=(0,f.useState)("0"),r=(0,o.Z)(n,2),w=r[0],b=r[1],k=(0,p.oQ)(e),S=k.mutate,A=(k.isLoading,(0,h.$)().t),B=(0,p.C5)(e),D=B.data,q=B.isLoading,z=(0,f.useMemo)((function(){return null===D||void 0===D?void 0:D.data()}),[D]),M=(0,p.wp)(null===z||void 0===z?void 0:z.schemaId),E=M.data,Q=M.isLoading,W=(0,f.useMemo)((function(){return null===E||void 0===E?void 0:E.data()}),[E]),F=(0,x.cI)(),$=F.control,L=F.handleSubmit,O=F.reset,V=(F.register,F.setValue,F.watch,(0,x.qo)({control:$,name:"phases"}));console.log(z,"tournament"),(0,f.useEffect)((function(){z&&W&&(null!==z&&void 0!==z&&z.phases?O(z):O((0,s.Z)((0,s.Z)({},z),{},{phases:(0,m.map)(null===W||void 0===W?void 0:W.phases,(function(e){return e.isGroupStage===j.Y.GroupStage?{groups:(0,m.map)(null===e||void 0===e?void 0:e.groups,(function(e){return{players:(0,m.map)((0,m.range)(0,e.playerCount),(function(){return{id:"",firstName:"",lastName:""}})),results:[]}}))}:{results:(0,m.map)((0,m.range)(0,Number(e.pairCount)||0),(function(){return{playerA:{id:"",score:""},playerB:{id:"",score:""}}}))}}))})))}),[O,z,W]);var G=(0,f.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he.Update;return function(){L(function(){var n=(0,a.Z)((0,t.Z)().mark((function n(r){return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:S((0,s.Z)((0,s.Z)({},r),{},{startDate:e===he.Start?(0,je.Z)(new Date,P.dq):r.startDate,endDate:e===he.End?(0,je.Z)(new Date,P.dq):r.endDate})),console.log(r,"data");case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(e){console.log(e)}))()}}),[L,S]);return(0,v.Z)((function(){z&&W&&G()(),console.log("odpalamy")}),3e3,[V]),(0,C.jsx)(N.g,{loading:q||Q,children:(0,C.jsxs)(l.Z,{children:[(0,C.jsx)(u.Z,{value:w,onChange:function(e,n){b(n)},variant:"scrollable",children:(0,m.map)(null===W||void 0===W?void 0:W.phases,(function(e,n){return(0,C.jsx)(d.Z,{label:e.name,value:String(n)},n)}))}),W&&(0,m.map)(null===W||void 0===W?void 0:W.phases,(function(e,n){return(0,C.jsx)(I,{value:w,index:String(n),className:"p-3",children:e.isGroupStage===j.Y.Cup?(0,C.jsx)(ve,{schema:W,index:n,control:$}):(0,C.jsx)(me,{schema:W,index:n,control:$})},n)})),(0,C.jsxs)(c.Z,{className:"px-6 pb-4",children:[(null===z||void 0===z?void 0:z.startDate)&&!(null!==z&&void 0!==z&&z.endDate)&&(0,C.jsx)(i.Z,{onClick:G(he.End),startIcon:(0,C.jsx)(Z.Z,{}),color:"primary",children:A("Zako\u0144cz turniej")}),!(null!==z&&void 0!==z&&z.startDate)&&!(null!==z&&void 0!==z&&z.endDate)&&(0,C.jsx)(i.Z,{onClick:G(he.Start),startIcon:(0,C.jsx)(y.Z,{}),color:"primary",children:A("Wystartuj turniej")})]})]})})}}}]);
//# sourceMappingURL=208.e71fbcd1.chunk.js.map